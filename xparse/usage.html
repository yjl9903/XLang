<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用 XParse 命令行工具 | XLang</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="A Simple Programming Language Powered by XLex and XParse.">
    
    <link rel="preload" href="/assets/css/0.styles.680745fd.css" as="style"><link rel="preload" href="/assets/js/app.f5e6def7.js" as="script"><link rel="preload" href="/assets/js/2.8b492b7e.js" as="script"><link rel="preload" href="/assets/js/23.546db149.js" as="script"><link rel="prefetch" href="/assets/js/10.bd9d8196.js"><link rel="prefetch" href="/assets/js/11.56940f5c.js"><link rel="prefetch" href="/assets/js/12.120d72ef.js"><link rel="prefetch" href="/assets/js/13.9d3123d5.js"><link rel="prefetch" href="/assets/js/14.4b9bbd83.js"><link rel="prefetch" href="/assets/js/15.80d5cc20.js"><link rel="prefetch" href="/assets/js/16.9a2bf8b9.js"><link rel="prefetch" href="/assets/js/17.1bfb87bc.js"><link rel="prefetch" href="/assets/js/18.9def0742.js"><link rel="prefetch" href="/assets/js/19.8275e46b.js"><link rel="prefetch" href="/assets/js/20.a1fca922.js"><link rel="prefetch" href="/assets/js/21.88a55443.js"><link rel="prefetch" href="/assets/js/22.7ecc4734.js"><link rel="prefetch" href="/assets/js/3.dd66873b.js"><link rel="prefetch" href="/assets/js/4.a7f51ca2.js"><link rel="prefetch" href="/assets/js/5.44f1ea06.js"><link rel="prefetch" href="/assets/js/6.962ff319.js"><link rel="prefetch" href="/assets/js/7.25da0c18.js"><link rel="prefetch" href="/assets/js/8.9dda87bb.js"><link rel="prefetch" href="/assets/js/9.2ff73d2a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.680745fd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">XLang</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/xlang/" class="nav-link">
  XLang
</a></div><div class="nav-item"><a href="/xlex/" class="nav-link">
  XLex
</a></div><div class="nav-item"><a href="/xparse/" class="nav-link router-link-active">
  XParse
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/xlang/" class="nav-link">
  XLang
</a></div><div class="nav-item"><a href="/xlex/" class="nav-link">
  XLex
</a></div><div class="nav-item"><a href="/xparse/" class="nav-link router-link-active">
  XParse
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>XLang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>XLex</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>XParse</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/xparse/" aria-current="page" class="sidebar-link">XParse 介绍</a></li><li><a href="/xparse/usage.html" aria-current="page" class="active sidebar-link">使用 XParse 命令行工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/xparse/usage.html#获取帮助" class="sidebar-link">获取帮助</a></li><li class="sidebar-sub-header"><a href="/xparse/usage.html#解析-token-流" class="sidebar-link">解析 Token 流</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他应用</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="获取帮助"><a href="#获取帮助" class="header-anchor">#</a> 获取帮助</h2> <p>在终端中输入以下命令，即可查看命令行工具的帮助。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>xparse --help
</code></pre></div><p><a href="https://www.npmjs.com/package/@xlor/xparse" target="_blank" rel="noopener noreferrer">XParse v1.0.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的帮助内容如下所示。</p> <div class="language-text extra-class"><pre class="language-text"><code>XParse/1.0.1

Usage:
  $ XParse

Commands:
  build  Build LR Parser
         Run LR Parser

For more info, run any command with the `--help` flag:
  $ XParse build --help
  $ XParse --help

Options:
  --config &amp;lt;config&gt;  Config file path (default: xparse.config)
  -h, --help         Display this message
  -v, --version      Display version number
</code></pre></div><h2 id="解析-token-流"><a href="#解析-token-流" class="header-anchor">#</a> 解析 Token 流</h2> <p>在终端的工作目录下，创建 JavaScript 脚本文件 <code>xparse.config.js</code>（默认名称，你也可以使用手动指定文件）。</p> <p>我们首先使用 XLex 和 <a href="/xlex/usage.html#解析代码文本串">使用 XLex 命令行工具</a> 中的词法规则作为词法分析器，然后构造一个简单的语法规则，用于解析一个简单的整数算术表达式。</p> <p>当然，XParse 的实现和 XLex 没有任何关系，你也可以使用自己代码向 XParse 提供 Token 流，只要符合 XParse 接收 Token 的规则即可（Token 对象类型见 <a href="/xlex/usage.html#解析代码文本串">使用 XLex 命令行工具</a> 中的输出结果描述）。</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">hooks</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">tokens</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'Number'</span><span class="token punctuation">,</span>
    <span class="token string">'Plus'</span><span class="token punctuation">,</span>
    <span class="token string">'Minus'</span><span class="token punctuation">,</span>
    <span class="token string">'Mul'</span><span class="token punctuation">,</span>
    <span class="token string">'Div'</span><span class="token punctuation">,</span>
    <span class="token string">'LRound'</span><span class="token punctuation">,</span>
    <span class="token string">'RRound'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">types</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'calculator'</span><span class="token punctuation">,</span>
    <span class="token string">'term'</span><span class="token punctuation">,</span>
    <span class="token string">'factor'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">start</span><span class="token operator">:</span> <span class="token string">'calculator'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">productions</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'calculator'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'term'</span><span class="token punctuation">,</span> <span class="token string">'Plus'</span><span class="token punctuation">,</span> <span class="token string">'calculator'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> l <span class="token operator">+</span> r<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'term'</span><span class="token punctuation">,</span> <span class="token string">'Minus'</span><span class="token punctuation">,</span> <span class="token string">'calculator'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> l <span class="token operator">-</span> r<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'term'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'term'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'factor'</span><span class="token punctuation">,</span> <span class="token string">'Mul'</span><span class="token punctuation">,</span> <span class="token string">'term'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> l <span class="token operator">*</span> r<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'factor'</span><span class="token punctuation">,</span> <span class="token string">'Div'</span><span class="token punctuation">,</span> <span class="token string">'term'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> l <span class="token operator">/</span> r<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'factor'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token string">'factor'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'Plus'</span><span class="token punctuation">,</span> <span class="token string">'Number'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'Minus'</span><span class="token punctuation">,</span> <span class="token string">'Number'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token operator">-</span>value<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'Number'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">rule</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'LRound'</span><span class="token punctuation">,</span> <span class="token string">'calculator'</span><span class="token punctuation">,</span> <span class="token string">'RRound'</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token parameter">l<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> value<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>关于配置脚本的编写：</p> <ul><li><p>你必须使用 <a href="http://www.commonjs.org/" target="_blank" rel="noopener noreferrer">CommonJS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规范，将配置对象作为模块进行导出；</p></li> <li><p>配置对象包含五个属性（完整类型定义见 <a href="https://github.com/LonelyKuma/XParse/blob/master/src/LRparser/type.ts#L22" target="_blank" rel="noopener noreferrer">type.ts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）：</p> <ul><li><p><code>hooks</code>：可选项，配置语法分析的预处理和后处理钩子函数，你可以定义 <code>beforeCreate()</code> 和 <code>created()</code> 两个函数；</p></li> <li><p><code>tokens</code>：必选项，指定产生式中哪些是终结符；</p></li> <li><p><code>types</code>：必选项，指定产生式中哪些是非终结符；</p></li> <li><p><code>start</code>：必选项，指定文法的开始非终结符；</p></li> <li><p><code>productions</code>：必选项，配置所有文法规则，包含一个产生式数组，每个对象包含以下属性：</p> <ul><li><p><code>left</code>：产生式左部，一个字符串，必须是一个非终结符；</p></li> <li><p><code>right</code>：产生式右补，包含多个具体的产生式规则，每个对象包含以下属性：</p> <ul><li><p><code>rule</code>：产生式规则，是一个字符串数组，每个字符串代表一个终结符或者非终结符，特别地，空数组代表产生式右部为 ε；</p></li> <li><p><code>reduce()</code>：可选项，使用该产生式规约时计算综合属性的回调函数，XParse 会自动按照产生式中的顺序传入综合属性值作为参数，其中终结符传入的是词法值，非终结符是计算的综合属性值。</p></li></ul></li></ul></li></ul></li></ul> <p>保存配置脚本。XParse 从标准输入中读取 JSON 格式 Token 数组字符串，你可以按照对应格式手动编写，但是推荐使用 XLex 通过管道将输出定向到 XParse 的输入中。命令示例：</p> <p>Linux 终端或 Windows 控制台：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>xlex <span class="token operator">&lt;</span> code.txt <span class="token operator">|</span> xparse
</code></pre></div><p>Windows PowerShell：</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token function">Get-Content</span> code<span class="token punctuation">.</span>txt <span class="token punctuation">|</span> xlex <span class="token punctuation">|</span> xparse
</code></pre></div><p>表达式 <code>1 + 2 * (3 + 4)</code> 的输出结果为：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span> ok<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">15</span> <span class="token punctuation">}</span>
</code></pre></div><p>成功时，输出一个对象，包含属性 <code>ok</code>，值为 <code>true</code>，以及属性 <code>value</code> 包含最终根节点的综合属性值。</p> <p>表达式 <code>1 + 2 * (3 4)</code> 的输出结果为：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  ok<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  token<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> 'Number'<span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    position<span class="token operator">:</span> <span class="token punctuation">{</span> row<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> col<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> length<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>失败时，输出一个对象，包含属性 <code>ok</code>，值为 <code>false</code>，以及属性 <code>token</code> 或 <code>message</code> 表示发生错误的位置或错误信息。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/xparse/" class="prev router-link-active">
        XParse 介绍
      </a></span> <span class="next"><a href="/deep/setmap.html">
        SetMap
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f5e6def7.js" defer></script><script src="/assets/js/2.8b492b7e.js" defer></script><script src="/assets/js/23.546db149.js" defer></script>
  </body>
</html>
